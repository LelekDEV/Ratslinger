[gd_scene load_steps=27 format=4 uid="uid://gliuja466pg6"]

[ext_resource type="Texture2D" uid="uid://8qakvdh1gbpa" path="res://graphics/sand_tile.png" id="1_ncd4d"]
[ext_resource type="Script" uid="uid://h08581xbp5g1" path="res://scripts/game.gd" id="1_o8yes"]
[ext_resource type="PackedScene" uid="uid://gyh7j0jqrav6" path="res://scenes/player.tscn" id="1_rf1xt"]
[ext_resource type="PackedScene" uid="uid://lw0lbb371my5" path="res://scenes/crosshair.tscn" id="2_7dpn4"]
[ext_resource type="Script" uid="uid://cvi745bdmkf4h" path="res://scripts/ui.gd" id="2_ijxjl"]
[ext_resource type="PackedScene" uid="uid://djd1q01nwytri" path="res://scenes/ui_heart.tscn" id="4_55u7g"]
[ext_resource type="FontFile" uid="uid://sgwyci3gbawn" path="res://fonts/fffforward.ttf" id="4_836xp"]
[ext_resource type="Script" uid="uid://do3ehr4w1u0d6" path="res://scripts/camera.gd" id="4_bq78c"]
[ext_resource type="Texture2D" uid="uid://kk3dfut1xl6v" path="res://graphics/cacti.png" id="4_wcdyl"]
[ext_resource type="Texture2D" uid="uid://drekyvwt4e2on" path="res://graphics/arena_popup.png" id="4_xw82j"]
[ext_resource type="PackedScene" uid="uid://cxmq3gxpsmp2o" path="res://scenes/gate.tscn" id="10_2mmsw"]
[ext_resource type="Texture2D" uid="uid://ch8e5ex6v1k70" path="res://graphics/fence.png" id="12_l77qo"]
[ext_resource type="Script" uid="uid://c3ngnqrj3wq4k" path="res://scripts/player_death_handler.gd" id="12_xw82j"]

[sub_resource type="Theme" id="Theme_s3lrj"]
default_font = ExtResource("4_836xp")
default_font_size = 32

[sub_resource type="Animation" id="Animation_l77qo"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("FlashRect:color")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(1, 1, 1, 0)]
}

[sub_resource type="Animation" id="Animation_2mmsw"]
resource_name = "player_hit"
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("FlashRect:color")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(0.1, 1),
"update": 0,
"values": [Color(1, 1, 1, 0.3), Color(1, 1, 1, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_836xp"]
_data = {
&"RESET": SubResource("Animation_l77qo"),
&"player_hit": SubResource("Animation_2mmsw")
}

[sub_resource type="Animation" id="Animation_836xp"]
resource_name = "wave_cleared"
length = 0.5
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("MarginContainer/EnemiesLabel:theme_override_colors/font_color")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Color(0.7764706, 0.6313726, 0.39215687, 1), Color(0.95, 0.84866667, 0.57, 1)]
}

[sub_resource type="Animation" id="Animation_s3lrj"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("MarginContainer/EnemiesLabel:theme_override_colors/font_color")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(0.7764706, 0.6313726, 0.39215687, 1)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_sh5j3"]
_data = {
&"RESET": SubResource("Animation_s3lrj"),
&"wave_cleared": SubResource("Animation_836xp")
}

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_836xp"]
texture = ExtResource("12_l77qo")
texture_region_size = Vector2i(10, 27)
0:0/0 = 0
0:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-5, -13.5, 5, -13.5, 5, 13.5, -5, 13.5)

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_o8yes"]
texture = ExtResource("4_wcdyl")
0:0/size_in_atlas = Vector2i(2, 3)
0:0/0 = 0
0:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-10, -20, 10, -20, 10, 20, -10, 20)
2:0/size_in_atlas = Vector2i(2, 3)
2:0/0 = 0
2:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-10, -20, 10, -20, 10, 20, -10, 20)
4:0/size_in_atlas = Vector2i(2, 3)
4:0/0 = 0
4:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-10, -20, 10, -20, 10, 20, -10, 20)
0:3/0 = 0
0:3/0/physics_layer_0/polygon_0/points = PackedVector2Array(-4, -4, 4, -4, 4, 4, -4, 4)
1:3/0 = 0
1:3/0/physics_layer_0/polygon_0/points = PackedVector2Array(-4, -4, 4, -4, 4, 4, -4, 4)
2:3/0 = 0
2:3/0/physics_layer_0/polygon_0/points = PackedVector2Array(-6, -6, 6, -6, 6, 6, -6, 6)
3:3/0 = 0
3:3/0/physics_layer_0/polygon_0/points = PackedVector2Array(-6, -6, 6, -6, 6, 6, -6, 6)

[sub_resource type="TileSet" id="TileSet_bq78c"]
tile_size = Vector2i(4, 4)
physics_layer_0/collision_layer = 2
physics_layer_0/collision_mask = 2
sources/1 = SubResource("TileSetAtlasSource_o8yes")
sources/0 = SubResource("TileSetAtlasSource_836xp")

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_l77qo"]
distance = -234.0

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_836xp"]
normal = Vector2(0, 1)
distance = -234.0

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_s3lrj"]
normal = Vector2(-1, 0)
distance = -324.0

[node name="Game" type="Node2D"]
y_sort_enabled = true
script = ExtResource("1_o8yes")

[node name="UI" type="CanvasLayer" parent="." groups=["ui"]]
layer = 0
script = ExtResource("2_ijxjl")

[node name="FlashRect" type="ColorRect" parent="UI"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
color = Color(1, 1, 1, 0)
metadata/_edit_lock_ = true

[node name="Hearts" type="HBoxContainer" parent="UI"]
z_index = 10
offset_left = -144.0
offset_top = -81.0
offset_right = 56.0
offset_bottom = -31.0
theme_override_constants/separation = 50

[node name="UIHeart1" parent="UI/Hearts" instance=ExtResource("4_55u7g")]
layout_mode = 2

[node name="UIHeart2" parent="UI/Hearts" instance=ExtResource("4_55u7g")]
layout_mode = 2

[node name="MarginContainer" type="MarginContainer" parent="UI"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 16
theme_override_constants/margin_top = 16
theme_override_constants/margin_right = 16
theme_override_constants/margin_bottom = 16

[node name="EnemiesLabel" type="Label" parent="UI/MarginContainer"]
layout_mode = 2
size_flags_horizontal = 8
size_flags_vertical = 0
theme = SubResource("Theme_s3lrj")
theme_override_colors/font_color = Color(0.7764706, 0.6313726, 0.39215687, 1)
text = "Enemies killed: 0/5"

[node name="LocationPopup" type="Sprite2D" parent="UI"]
texture = ExtResource("4_xw82j")

[node name="AnimationPlayer1" type="AnimationPlayer" parent="UI"]
libraries = {
&"": SubResource("AnimationLibrary_836xp")
}

[node name="AnimationPlayer2" type="AnimationPlayer" parent="UI"]
libraries = {
&"": SubResource("AnimationLibrary_sh5j3")
}

[node name="Sand1" type="Sprite2D" parent="."]
z_index = -1
texture_repeat = 2
texture = ExtResource("1_ncd4d")
region_enabled = true
region_rect = Rect2(0, 0, 648, 468)
metadata/_edit_lock_ = true

[node name="Sand2" type="Sprite2D" parent="."]
z_index = -1
texture_repeat = 2
position = Vector2(-648, 0)
texture = ExtResource("1_ncd4d")
region_enabled = true
region_rect = Rect2(0, 0, 648, 468)
metadata/_edit_lock_ = true

[node name="Player" parent="." node_paths=PackedStringArray("gate") groups=["player"] instance=ExtResource("1_rf1xt")]
gate = NodePath("../Gate")
metadata/_edit_lock_ = true

[node name="Camera2D" type="Camera2D" parent="Player" node_paths=PackedStringArray("gate")]
process_mode = 3
zoom = Vector2(4, 4)
process_callback = 0
limit_top = -234
limit_right = 324
limit_bottom = 234
position_smoothing_enabled = true
script = ExtResource("4_bq78c")
gate = NodePath("../../Gate")

[node name="Enemies" type="Node2D" parent="."]
y_sort_enabled = true

[node name="Projectiles" type="Node2D" parent="." groups=["projectiles"]]
y_sort_enabled = true

[node name="Bullets" type="Node2D" parent="." groups=["bullets"]]
y_sort_enabled = true

[node name="Gate" parent="." instance=ExtResource("10_2mmsw")]
position = Vector2(-298, 0)

[node name="Crosshair" parent="." instance=ExtResource("2_7dpn4")]
z_index = 1
metadata/_edit_lock_ = true

[node name="TileMapLayer" type="TileMapLayer" parent="."]
tile_map_data = PackedByteArray("AADL/8v/AQAAAAAAAADb/83/AQACAAAAAADk/83/AQACAAMAAADu/8z/AQAAAAAAAAD6/87/AQADAAMAAAACAMv/AQAAAAMAAAAIAM7/AQABAAMAAAASAMz/AQACAAAAAAAfAMv/AQAEAAAAAAApAM7/AQACAAMAAAAyAMz/AQACAAMAAAA7AM3/AQAAAAAAAABGAMz/AQACAAAAAABLANj/AQAAAAAAAABHAOP/AQADAAMAAABLAOr/AQABAAMAAABHAO3/AQAAAAMAAABLAPL/AQACAAMAAABHAPn/AQAAAAAAAABMAAMAAQAEAAAAAABIAA8AAQACAAAAAABMABgAAQACAAMAAABIAB4AAQADAAMAAABLACgAAQACAAAAAABFADMAAQAAAAAAAAA6ADEAAQADAAMAAAA0ADIAAQAAAAAAAAAsADEAAQAAAAMAAAAmADQAAQAAAAMAAAAeADEAAQACAAMAAAAVADMAAQACAAAAAAALADMAAQADAAMAAAACADAAAQACAAMAAAAAADYAAQABAAMAAAD3/zMAAQAEAAAAAADu/zIAAQAAAAAAAADg/zMAAQACAAAAAADW/zIAAQACAAMAAADO/zYAAQADAAMAAADJ/zAAAQACAAMAAADF/zUAAQABAAMAAADA/zQAAQAAAAMAAAC4/zIAAQACAAAAAACy/yUAAQAAAAAAAADD/8n/AQADAAMAAAC7/87/AQADAAMAAACz/9X/AQACAAAAAAC2/9v/AAAAAAAAAAC2/+P/AAAAAAAAAAC2/+v/AAAAAAAAAAC2//P/AAAAAAAAAAC2/w4AAAAAAAAAAAC2/xYAAAAAAAAAAAC2/x4AAAAAAAAAAAC2/yYAAAAAAAAAAAA=")
tile_set = SubResource("TileSet_bq78c")

[node name="WorldBounds" type="StaticBody2D" parent="."]
collision_layer = 2
collision_mask = 2

[node name="BottomShape" type="CollisionShape2D" parent="WorldBounds"]
shape = SubResource("WorldBoundaryShape2D_l77qo")

[node name="TopShape" type="CollisionShape2D" parent="WorldBounds"]
shape = SubResource("WorldBoundaryShape2D_836xp")

[node name="RightShape" type="CollisionShape2D" parent="WorldBounds"]
shape = SubResource("WorldBoundaryShape2D_s3lrj")

[node name="ReferenceRect" type="ReferenceRect" parent="."]
offset_left = -270.0
offset_top = -180.0
offset_right = 270.0
offset_bottom = 180.0
metadata/_edit_lock_ = true

[node name="PlayerDeathHandler" type="Node2D" parent="." node_paths=PackedStringArray("camera", "death_shadow_rect", "ui")]
process_mode = 3
z_index = 10
script = ExtResource("12_xw82j")
camera = NodePath("../Player/Camera2D")
death_shadow_rect = NodePath("../DeathShadowRect")
ui = NodePath("../UI")

[node name="DeathShadowRect" type="ColorRect" parent="."]
visible = false
z_index = 10
offset_left = -972.0
offset_top = -234.0
offset_right = 324.0
offset_bottom = 234.0
color = Color(0, 0, 0, 1)

[node name="EnemySpawnTimer" type="Timer" parent="."]
wait_time = 8.0
autostart = true

[connection signal="timeout" from="EnemySpawnTimer" to="." method="_on_enemy_spawn_timer_timeout"]
